<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SneakyFS: index_block.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SneakyFS
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Secure UNIX File System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index__block_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">index_block.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="index__block_8h_source.html">index_block.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="glob__func_8h_source.html">glob_func.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="block__func_8h_source.html">block_func.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for index_block.c:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c__incl.png" border="0" usemap="#index__block_8c" alt=""/></div>
<map name="index__block_8c" id="index__block_8c">
<area shape="rect" id="node3" href="index__block_8h.html" title="index_block.h" alt="" coords="171,155,273,181"/><area shape="rect" id="node13" href="glob__func_8h.html" title="glob_func.h" alt="" coords="298,155,387,181"/><area shape="rect" id="node24" href="block__func_8h.html" title="block_func.h" alt="" coords="48,80,144,107"/><area shape="rect" id="node5" href="glob__data_8h.html" title="glob_data.h" alt="" coords="109,229,197,256"/><area shape="rect" id="node11" href="error_8h.html" title="error.h" alt="" coords="25,229,83,256"/><area shape="rect" id="node26" href="blockio_8h.html" title="blockio.h" alt="" coords="21,155,95,181"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aef23bf42ec9f8215f800e36ed19f3684"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdata__index.html">data_index</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#aef23bf42ec9f8215f800e36ed19f3684">generate_index</a> (uint32_t num_blocks)</td></tr>
<tr class="memdesc:aef23bf42ec9f8215f800e36ed19f3684"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates the indexes for the data blocks and then writes the indexes (which contain the locations of data blocks) to disk.  <a href="#aef23bf42ec9f8215f800e36ed19f3684"></a><br/></td></tr>
<tr class="separator:aef23bf42ec9f8215f800e36ed19f3684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd54d9d51e9832a5a52ac0aa470b0d12"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#afd54d9d51e9832a5a52ac0aa470b0d12">rebuild_index</a> (<a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> data_locations)</td></tr>
<tr class="memdesc:afd54d9d51e9832a5a52ac0aa470b0d12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a series of loose data block locations and builds a new index to link them with an inode.  <a href="#afd54d9d51e9832a5a52ac0aa470b0d12"></a><br/></td></tr>
<tr class="separator:afd54d9d51e9832a5a52ac0aa470b0d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c6c55e76e88de10da638a624574947"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#a58c6c55e76e88de10da638a624574947">iterate_index</a> (uint32_t location, <a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> data_blocks)</td></tr>
<tr class="memdesc:a58c6c55e76e88de10da638a624574947"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes an index block data structure and returns the locations of all data blocks which it links to.  <a href="#a58c6c55e76e88de10da638a624574947"></a><br/></td></tr>
<tr class="separator:a58c6c55e76e88de10da638a624574947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bfc6472e986ea83b6f5a14def157883"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#a7bfc6472e986ea83b6f5a14def157883">calc_index_blocks</a> (uint32_t num_blocks)</td></tr>
<tr class="memdesc:a7bfc6472e986ea83b6f5a14def157883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of index blocks that are needed in order to write the number of data blocks specified to the file system.  <a href="#a7bfc6472e986ea83b6f5a14def157883"></a><br/></td></tr>
<tr class="separator:a7bfc6472e986ea83b6f5a14def157883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b873a6bb0f0535b8044df681c21fe20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#a1b873a6bb0f0535b8044df681c21fe20">count_files_in_dir</a> (uint32_t location)</td></tr>
<tr class="memdesc:a1b873a6bb0f0535b8044df681c21fe20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for iterate_index which simply gives you a count of the number of files in a directory.  <a href="#a1b873a6bb0f0535b8044df681c21fe20"></a><br/></td></tr>
<tr class="separator:a1b873a6bb0f0535b8044df681c21fe20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8336ecef5a6f9f6881a3e6a498bc543"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="index__block_8c.html#aa8336ecef5a6f9f6881a3e6a498bc543">index_block_locations</a> (uint32_t location, <a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> index_blocks)</td></tr>
<tr class="memdesc:aa8336ecef5a6f9f6881a3e6a498bc543"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides the locations of the index blocks within an index block data structure.  <a href="#aa8336ecef5a6f9f6881a3e6a498bc543"></a><br/></td></tr>
<tr class="separator:aa8336ecef5a6f9f6881a3e6a498bc543"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7bfc6472e986ea83b6f5a14def157883"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t calc_index_blocks </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_blocks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of index blocks that are needed in order to write the number of data blocks specified to the file system. </p>
<p>This function uses a calculation based on the specified block size of the disk in order to determine how many locations can be indexed within one block, and then divides the number of specified blocks by this value. Since fractions of blocks are not allowed, the function then ceilings the resultant value in order to provide the full length of the required data structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_blocks</td><td>The number of data blocks required to be indexed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the number of index blocks needed to write the data blocks to the file system.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_a7bfc6472e986ea83b6f5a14def157883_icgraph.png" border="0" usemap="#index__block_8c_a7bfc6472e986ea83b6f5a14def157883_icgraph" alt=""/></div>
<map name="index__block_8c_a7bfc6472e986ea83b6f5a14def157883_icgraph" id="index__block_8c_a7bfc6472e986ea83b6f5a14def157883_icgraph">
<area shape="rect" id="node3" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="184,5,259,32"/><area shape="rect" id="node5" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="307,5,376,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1b873a6bb0f0535b8044df681c21fe20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int count_files_in_dir </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>location</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for iterate_index which simply gives you a count of the number of files in a directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">location</td><td>The location of the index block on disk to iterate across.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the number of locations found in the index block. If return = 0 then the directory is empty. If return &gt; 0 then the function was successful, and if return = -1 then the function was unsuccessful.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_cgraph.png" border="0" usemap="#index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_cgraph" alt=""/></div>
<map name="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_cgraph" id="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_cgraph">
<area shape="rect" id="node3" href="index__block_8c.html#a58c6c55e76e88de10da638a624574947" title="This function takes an index block data structure and returns the locations of all data blocks which ..." alt="" coords="176,56,272,83"/><area shape="rect" id="node14" href="error_8c.html#af85f0519da49c9e50bf3d1feffa74ef3" title="Prints an error code." alt="" coords="184,107,264,133"/><area shape="rect" id="node5" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="320,5,405,32"/><area shape="rect" id="node9" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="332,56,393,83"/><area shape="rect" id="node11" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="320,107,405,133"/><area shape="rect" id="node7" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="454,5,533,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_icgraph.png" border="0" usemap="#index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_icgraph" alt=""/></div>
<map name="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_icgraph" id="index__block_8c_a1b873a6bb0f0535b8044df681c21fe20_icgraph">
<area shape="rect" id="node3" href="get__size_8h.html#a9abcf2f46b77ed569f2a64407e656d22" title="Get the size (in blocks) of the file with the pathname specified." alt="" coords="177,5,266,32"/><area shape="rect" id="node7" href="read__dir_8h.html#a7b19aab55aa6358fab1f66a63810b358" title="List the contents of a directory." alt="" coords="178,56,265,83"/><area shape="rect" id="node5" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="315,31,384,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef23bf42ec9f8215f800e36ed19f3684"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdata__index.html">data_index</a> generate_index </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_blocks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates the indexes for the data blocks and then writes the indexes (which contain the locations of data blocks) to disk. </p>
<p>This function returns a <a class="el" href="structdata__index.html">data_index</a> pseudo-object which contains the location of the first index block, and the locations of all the data blocks indexed by the all the indices (spanning the entire index data structure).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_blocks</td><td>The number of blocks to generate indexes for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a <a class="el" href="structdata__index.html">data_index</a> struct which contains the location of the first index block, and the locations of all data blocks indexed</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_cgraph.png" border="0" usemap="#index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_cgraph" alt=""/></div>
<map name="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_cgraph" id="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_cgraph">
<area shape="rect" id="node3" href="free__block__list_8c.html#acbfc0a3810742af6e976d135071261e1" title="Finds the next free block in the static free block list, marks it as used and returns the location of..." alt="" coords="165,56,272,83"/><area shape="rect" id="node7" href="block__func_8c.html#a8d2c516f00e918d009b5fbaf1cfa463b" title="A wrapper for the put_block function." alt="" coords="352,107,440,133"/><area shape="rect" id="node14" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="176,157,261,184"/><area shape="rect" id="node5" href="free__block__list_8c.html#a82bb5a646a9f221b4b1b333cd1e142ea" title="Used to calculate whether there is enough disk space before starting to create a file on disk..." alt="" coords="320,5,472,32"/><area shape="rect" id="node11" href="free__block__list_8c.html#adafbfcac2573a9ee6a15645d4fe825c0" title="Accessor method for the free block list static instance in memory." alt="" coords="355,56,437,83"/><area shape="rect" id="node9" href="blockio_8c.html#a800219862241422fe7dee4411b4b995e" title="Writes a block to disk." alt="" coords="521,107,599,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_icgraph.png" border="0" usemap="#index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_icgraph" alt=""/></div>
<map name="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_icgraph" id="index__block_8c_aef23bf42ec9f8215f800e36ed19f3684_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="177,56,260,83"/><area shape="rect" id="node10" href="initialize_8h.html#a00a2a52d3dc5dd4ec595881132e0e280" title="Allocate all of the blocks in the free block list." alt="" coords="165,5,272,32"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="321,5,415,32"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="464,31,533,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa8336ecef5a6f9f6881a3e6a498bc543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> index_block_locations </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td>
          <td class="paramname"><em>index_blocks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides the locations of the index blocks within an index block data structure. </p>
<p>This function iterates recursively through the index blocks in an index block data structure and returns a pointer to a NULL terminated array containing all of the index block locations on disk. If an error occurs then NULL is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">location</td><td>The location of the first index block.</td></tr>
    <tr><td class="paramname">index_blocks</td><td>An argument used by the function when it recursively calls itself, the argument should be NULL when calling index_block_locations for the first index location.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a list of index block locations. If there is an error the value returned will be NULL.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_cgraph.png" border="0" usemap="#index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_cgraph" alt=""/></div>
<map name="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_cgraph" id="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_cgraph">
<area shape="rect" id="node3" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="205,5,291,32"/><area shape="rect" id="node7" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="205,56,291,83"/><area shape="rect" id="node9" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="217,107,279,133"/><area shape="rect" id="node5" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="339,5,418,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_icgraph.png" border="0" usemap="#index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_icgraph" alt=""/></div>
<map name="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_icgraph" id="index__block_8c_aa8336ecef5a6f9f6881a3e6a498bc543_icgraph">
<area shape="rect" id="node3" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="624,49,707,76"/><area shape="rect" id="node7" href="get__size_8h.html#a9abcf2f46b77ed569f2a64407e656d22" title="Get the size (in blocks) of the file with the pathname specified." alt="" coords="446,146,535,173"/><area shape="rect" id="node10" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="420,206,561,233"/><area shape="rect" id="node18" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="405,45,576,72"/><area shape="rect" id="node21" href="index__block_8h.html#aa8336ecef5a6f9f6881a3e6a498bc543" title="Provides the locations of the index blocks within an index block data structure." alt="" coords="206,108,357,134"/><area shape="rect" id="node28" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="453,257,528,284"/><area shape="rect" id="node5" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="899,156,968,182"/><area shape="rect" id="node12" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="624,206,707,233"/><area shape="rect" id="node14" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="755,156,850,182"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a58c6c55e76e88de10da638a624574947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> iterate_index </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td>
          <td class="paramname"><em>data_blocks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes an index block data structure and returns the locations of all data blocks which it links to. </p>
<p>This function iterates recursively through the index blocks and returns a pointer to a NULL terminated array containing all of the data block locations stored in the indices. In the case of large files that require multiple indexes, when we reach the value ceil(BLOCKSIZE/sizeof(uint32_t) which is the last entry in the index block, we recursively call iterate_index on the index block at this index. When we reach a NULL location inside the index block, we have reached the end of the indexes. The function returns a NULL pointer if an error occurred.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">location</td><td>The location of the first index block to iterate through.</td></tr>
    <tr><td class="paramname">data_blocks</td><td>An argument used by the function when it recursively calls itself, the argument should be NULL when calling iterate_index for the first index location.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to a NULL terminated array containing all of the data block locations stored in the indices, the pointer is NULL if an error occurred.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_a58c6c55e76e88de10da638a624574947_cgraph.png" border="0" usemap="#index__block_8c_a58c6c55e76e88de10da638a624574947_cgraph" alt=""/></div>
<map name="index__block_8c_a58c6c55e76e88de10da638a624574947_cgraph" id="index__block_8c_a58c6c55e76e88de10da638a624574947_cgraph">
<area shape="rect" id="node3" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="149,5,235,32"/><area shape="rect" id="node7" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="161,56,223,83"/><area shape="rect" id="node9" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="149,107,235,133"/><area shape="rect" id="node5" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="283,5,362,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_a58c6c55e76e88de10da638a624574947_icgraph.png" border="0" usemap="#index__block_8c_a58c6c55e76e88de10da638a624574947_icgraph" alt=""/></div>
<map name="index__block_8c_a58c6c55e76e88de10da638a624574947_icgraph" id="index__block_8c_a58c6c55e76e88de10da638a624574947_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="536,84,619,110"/><area shape="rect" id="node10" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="536,286,619,313"/><area shape="rect" id="node13" href="free__block__list_8h.html#a1a24d3e02317587656b22b7207cdb3fe" title="Synchronizes the free block static instance in memory by writing it to disk." alt="" coords="343,236,414,262"/><area shape="rect" id="node17" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="540,388,615,414"/><area shape="rect" id="node20" href="free__block__list_8h.html#ae1a3d63476e1321750e8e4aedbc53f07" title="Overwrites the free block list in memory with the most recent version on disk." alt="" coords="343,438,415,465"/><area shape="rect" id="node29" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="308,33,449,60"/><area shape="rect" id="node32" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="293,286,464,313"/><area shape="rect" id="node35" href="index__block_8h.html#a58c6c55e76e88de10da638a624574947" title="This function takes an index block data structure and returns the locations of all data blocks which ..." alt="" coords="149,361,245,388"/><area shape="rect" id="node44" href="index__block_8h.html#a1b873a6bb0f0535b8044df681c21fe20" title="Wrapper for iterate_index which simply gives you a count of the number of files in a directory..." alt="" coords="317,489,440,516"/><area shape="rect" id="node49" href="read__dir_8h.html#a7b19aab55aa6358fab1f66a63810b358" title="List the contents of a directory." alt="" coords="534,552,621,578"/><area shape="rect" id="node53" href="read__file_8h.html#a967ba612f53d696f2c63f49ae35c4f37" title="Read the contents of a file." alt="" coords="343,641,415,668"/><area shape="rect" id="node56" href="traverse__tree_8h.html#a91c00022d1ad5207d846646fac32e4b0" title="Traverse the file system structure." alt="" coords="307,134,450,161"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="691,134,786,161"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="835,312,904,338"/><area shape="rect" id="node23" href="free__block__list_8h.html#a4fb9e58d343f5d00bfddf8b2aabe4a05" title="Obtains a handle to the free block list static instance, regardless of whether it is available in mem..." alt="" coords="512,438,643,465"/><area shape="rect" id="node25" href="mount_8h.html#ad8988b7a3c735f8499da90b745024829" title="Attempt to mount the filesystem on disk." alt="" coords="709,438,768,465"/><area shape="rect" id="node46" href="get__size_8h.html#a9abcf2f46b77ed569f2a64407e656d22" title="Get the size (in blocks) of the file with the pathname specified." alt="" coords="533,337,622,364"/><area shape="rect" id="node61" href="get__type_8h.html#a8ce020071b4ba304d7bb45b6c1e246f5" title="Get the type of the file with the pathname specified." alt="" coords="693,236,784,262"/><area shape="rect" id="node64" href="open__file_8h.html#ae482b5d82cfd7a92ea1f2815c5965f3c" title="Opens the file specified by the pathname, if the file is successfully opened a file descriptor is ret..." alt="" coords="701,185,776,212"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afd54d9d51e9832a5a52ac0aa470b0d12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t rebuild_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td>
          <td class="paramname"><em>data_locations</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes a series of loose data block locations and builds a new index to link them with an inode. </p>
<p>This function takes a NULL terminated array of data locations and turns it into a new index structure, then writes it on disk and returns the location of the first index block. The function operates similar to generate_index except you already have all the data locations. If an error occurs 0 is returned. If NO data_locations are specified an empty index is created and the location is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_locations</td><td>A NULL terminated array of data locations, if NO data locations are provided an empty index is created and the location is returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The location of the FIRST index block, if an error occurs 0 is returned</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_cgraph.png" border="0" usemap="#index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_cgraph" alt=""/></div>
<map name="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_cgraph" id="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_cgraph">
<area shape="rect" id="node3" href="free__block__list_8c.html#acbfc0a3810742af6e976d135071261e1" title="Finds the next free block in the static free block list, marks it as used and returns the location of..." alt="" coords="152,56,259,83"/><area shape="rect" id="node7" href="block__func_8c.html#a8d2c516f00e918d009b5fbaf1cfa463b" title="A wrapper for the put_block function." alt="" coords="339,107,427,133"/><area shape="rect" id="node5" href="free__block__list_8c.html#a82bb5a646a9f221b4b1b333cd1e142ea" title="Used to calculate whether there is enough disk space before starting to create a file on disk..." alt="" coords="307,5,459,32"/><area shape="rect" id="node11" href="free__block__list_8c.html#adafbfcac2573a9ee6a15645d4fe825c0" title="Accessor method for the free block list static instance in memory." alt="" coords="341,56,424,83"/><area shape="rect" id="node9" href="blockio_8c.html#a800219862241422fe7dee4411b4b995e" title="Writes a block to disk." alt="" coords="507,107,586,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_icgraph.png" border="0" usemap="#index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_icgraph" alt=""/></div>
<map name="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_icgraph" id="index__block_8c_afd54d9d51e9832a5a52ac0aa470b0d12_icgraph">
<area shape="rect" id="node3" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="152,56,293,83"/><area shape="rect" id="node12" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="341,107,512,133"/><area shape="rect" id="node17" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="185,157,260,184"/><area shape="rect" id="node5" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="385,56,468,83"/><area shape="rect" id="node7" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="561,5,655,32"/><area shape="rect" id="node9" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="704,81,773,108"/><area shape="rect" id="node14" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="567,107,649,133"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="index__block_8c.html">index_block.c</a></li>
    
    
    
  </ul>
</div>
</body>
</html>
