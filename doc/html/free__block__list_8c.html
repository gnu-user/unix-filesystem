<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SneakyFS: free_block_list.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SneakyFS
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Secure UNIX File System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('free__block__list_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">free_block_list.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="free__block__list_8h_source.html">free_block_list.h</a>&quot;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for free_block_list.c:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c__incl.png" border="0" usemap="#free__block__list_8c" alt=""/></div>
<map name="free__block__list_8c" id="free__block__list_8c">
<area shape="rect" id="node3" href="free__block__list_8h.html" title="free_block_list.h" alt="" coords="201,80,317,107"/><area shape="rect" id="node5" href="glob__data_8h.html" title="glob_data.h" alt="" coords="37,155,125,181"/><area shape="rect" id="node11" href="error_8h.html" title="error.h" alt="" coords="151,155,208,181"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4fb9e58d343f5d00bfddf8b2aabe4a05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfree__block__list.html">free_block_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#a4fb9e58d343f5d00bfddf8b2aabe4a05">get_free_block_list</a> (void)</td></tr>
<tr class="memdesc:a4fb9e58d343f5d00bfddf8b2aabe4a05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains a handle to the free block list static instance, regardless of whether it is available in memory or on disk.  <a href="#a4fb9e58d343f5d00bfddf8b2aabe4a05"></a><br/></td></tr>
<tr class="separator:a4fb9e58d343f5d00bfddf8b2aabe4a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4006c8928b03cc8367e345842cd263ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#a4006c8928b03cc8367e345842cd263ae">calc_total_free_blocks</a> (void)</td></tr>
<tr class="memdesc:a4006c8928b03cc8367e345842cd263ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to calculate the total amount of available disk space.  <a href="#a4006c8928b03cc8367e345842cd263ae"></a><br/></td></tr>
<tr class="separator:a4006c8928b03cc8367e345842cd263ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82bb5a646a9f221b4b1b333cd1e142ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#a82bb5a646a9f221b4b1b333cd1e142ea">calc_num_free_blocks</a> (uint32_t num_blocks)</td></tr>
<tr class="memdesc:a82bb5a646a9f221b4b1b333cd1e142ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to calculate whether there is enough disk space before starting to create a file on disk.  <a href="#a82bb5a646a9f221b4b1b333cd1e142ea"></a><br/></td></tr>
<tr class="separator:a82bb5a646a9f221b4b1b333cd1e142ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbfc0a3810742af6e976d135071261e1"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#acbfc0a3810742af6e976d135071261e1">get_free_block</a> (void)</td></tr>
<tr class="memdesc:acbfc0a3810742af6e976d135071261e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the next free block in the static free block list, marks it as used and returns the location of the block.  <a href="#acbfc0a3810742af6e976d135071261e1"></a><br/></td></tr>
<tr class="separator:acbfc0a3810742af6e976d135071261e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafbfcac2573a9ee6a15645d4fe825c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfree__block__list.html">free_block_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#adafbfcac2573a9ee6a15645d4fe825c0">update_fbl</a> (<a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> used, <a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> free)</td></tr>
<tr class="memdesc:adafbfcac2573a9ee6a15645d4fe825c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor method for the free block list static instance in memory.  <a href="#adafbfcac2573a9ee6a15645d4fe825c0"></a><br/></td></tr>
<tr class="separator:adafbfcac2573a9ee6a15645d4fe825c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a24d3e02317587656b22b7207cdb3fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfree__block__list.html">free_block_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#a1a24d3e02317587656b22b7207cdb3fe">sync_fbl</a> (void)</td></tr>
<tr class="memdesc:a1a24d3e02317587656b22b7207cdb3fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronizes the free block static instance in memory by writing it to disk.  <a href="#a1a24d3e02317587656b22b7207cdb3fe"></a><br/></td></tr>
<tr class="separator:a1a24d3e02317587656b22b7207cdb3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a3d63476e1321750e8e4aedbc53f07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfree__block__list.html">free_block_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#ae1a3d63476e1321750e8e4aedbc53f07">reset_fbl</a> (void)</td></tr>
<tr class="memdesc:ae1a3d63476e1321750e8e4aedbc53f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overwrites the free block list in memory with the most recent version on disk.  <a href="#ae1a3d63476e1321750e8e4aedbc53f07"></a><br/></td></tr>
<tr class="separator:ae1a3d63476e1321750e8e4aedbc53f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e849ebe5efb8153894a337356a4e328"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structfree__block__list.html">free_block_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="free__block__list_8c.html#a9e849ebe5efb8153894a337356a4e328">wipe_fbl</a> (void)</td></tr>
<tr class="memdesc:a9e849ebe5efb8153894a337356a4e328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinitializes the free block list in memory.  <a href="#a9e849ebe5efb8153894a337356a4e328"></a><br/></td></tr>
<tr class="separator:a9e849ebe5efb8153894a337356a4e328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a82bb5a646a9f221b4b1b333cd1e142ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> calc_num_free_blocks </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_blocks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to calculate whether there is enough disk space before starting to create a file on disk. </p>
<p>Finds the specified number of free blocks in the static instance of the free block list in memory. It returns NULL if there are not enough free blocks, otherwise it returns an array of the free locations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_blocks</td><td>The number of free blocks needed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an array of the free locations, or NULL if there are not enough free blocks.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a82bb5a646a9f221b4b1b333cd1e142ea_icgraph.png" border="0" usemap="#free__block__list_8c_a82bb5a646a9f221b4b1b333cd1e142ea_icgraph" alt=""/></div>
<map name="free__block__list_8c_a82bb5a646a9f221b4b1b333cd1e142ea_icgraph" id="free__block__list_8c_a82bb5a646a9f221b4b1b333cd1e142ea_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="737,56,820,82"/><area shape="rect" id="node10" href="free__block__list_8h.html#acbfc0a3810742af6e976d135071261e1" title="Finds the next free block in the static free block list, marks it as used and returns the location of..." alt="" coords="205,106,312,133"/><area shape="rect" id="node30" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="555,208,629,234"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="881,106,975,133"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="1024,132,1093,158"/><area shape="rect" id="node13" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="507,157,677,184"/><area shape="rect" id="node18" href="index__block_8h.html#aef23bf42ec9f8215f800e36ed19f3684" title="Generates the indexes for the data blocks and then writes the indexes (which contain the locations of..." alt="" coords="537,56,647,82"/><area shape="rect" id="node24" href="index__block_8h.html#afd54d9d51e9832a5a52ac0aa470b0d12" title="Takes a series of loose data block locations and builds a new index to link them with an inode..." alt="" coords="360,106,459,133"/><area shape="rect" id="node15" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="887,157,969,184"/><area shape="rect" id="node21" href="initialize_8h.html#a00a2a52d3dc5dd4ec595881132e0e280" title="Allocate all of the blocks in the free block list." alt="" coords="725,106,832,133"/><area shape="rect" id="node26" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="521,106,663,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4006c8928b03cc8367e345842cd263ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a> calc_total_free_blocks </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to calculate the total amount of available disk space. </p>
<p>Finds all of the free blocks that exist in the static instance of the free block list in memory and returns them as a locations object.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns an array containing all of the free locations.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a4006c8928b03cc8367e345842cd263ae_icgraph.png" border="0" usemap="#free__block__list_8c_a4006c8928b03cc8367e345842cd263ae_icgraph" alt=""/></div>
<map name="free__block__list_8c_a4006c8928b03cc8367e345842cd263ae_icgraph" id="free__block__list_8c_a4006c8928b03cc8367e345842cd263ae_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="205,56,288,83"/><area shape="rect" id="node10" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="347,107,421,133"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="337,5,431,32"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="480,56,549,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acbfc0a3810742af6e976d135071261e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t get_free_block </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the next free block in the static free block list, marks it as used and returns the location of the block. </p>
<p>This function finds a single free block and then marks that block as used in the free block list, it ensures that the block on disk is empty (all NULL) before returning the block location. It essentially operates as a facade for the calc_free_blocks function and the update_fbl function when you only want to get one block at a time. If there are no free blocks available, it will return 0 (the superblock's location), which is always used by the superblock.</p>
<dl class="section return"><dt>Returns</dt><dd>The location of a free block. Return 0 if no free blocks available.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_cgraph.png" border="0" usemap="#free__block__list_8c_acbfc0a3810742af6e976d135071261e1_cgraph" alt=""/></div>
<map name="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_cgraph" id="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_cgraph">
<area shape="rect" id="node3" href="free__block__list_8c.html#a82bb5a646a9f221b4b1b333cd1e142ea" title="Used to calculate whether there is enough disk space before starting to create a file on disk..." alt="" coords="160,5,312,32"/><area shape="rect" id="node5" href="block__func_8c.html#a8d2c516f00e918d009b5fbaf1cfa463b" title="A wrapper for the put_block function." alt="" coords="192,56,280,83"/><area shape="rect" id="node9" href="free__block__list_8c.html#adafbfcac2573a9ee6a15645d4fe825c0" title="Accessor method for the free block list static instance in memory." alt="" coords="195,107,277,133"/><area shape="rect" id="node7" href="blockio_8c.html#a800219862241422fe7dee4411b4b995e" title="Writes a block to disk." alt="" coords="361,56,439,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_icgraph.png" border="0" usemap="#free__block__list_8c_acbfc0a3810742af6e976d135071261e1_icgraph" alt=""/></div>
<map name="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_icgraph" id="free__block__list_8c_acbfc0a3810742af6e976d135071261e1_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="537,29,620,56"/><area shape="rect" id="node10" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="307,131,477,157"/><area shape="rect" id="node15" href="index__block_8h.html#aef23bf42ec9f8215f800e36ed19f3684" title="Generates the indexes for the data blocks and then writes the indexes (which contain the locations of..." alt="" coords="337,29,447,56"/><area shape="rect" id="node21" href="index__block_8h.html#afd54d9d51e9832a5a52ac0aa470b0d12" title="Takes a series of loose data block locations and builds a new index to link them with an inode..." alt="" coords="160,80,259,107"/><area shape="rect" id="node27" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="355,181,429,208"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="681,80,775,107"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="824,105,893,132"/><area shape="rect" id="node12" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="687,131,769,157"/><area shape="rect" id="node18" href="initialize_8h.html#a00a2a52d3dc5dd4ec595881132e0e280" title="Allocate all of the blocks in the free block list." alt="" coords="525,80,632,107"/><area shape="rect" id="node23" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="321,80,463,107"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4fb9e58d343f5d00bfddf8b2aabe4a05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfree__block__list.html">free_block_list</a>* get_free_block_list </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains a handle to the free block list static instance, regardless of whether it is available in memory or on disk. </p>
<p>Gets the free block list independently from where it is located. If the free block list does not already exist in memory (file system has just started) it will read the free block list from disk using the index provided by the super block and set the static instance of the free block list in memory. Then, return the pointer to the static instance in memory. If an error occurs, a NULL pointer is returned.</p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the static instance of free block list in memory, NULL if an error occurred.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_cgraph.png" border="0" usemap="#free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_cgraph" alt=""/></div>
<map name="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_cgraph" id="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_cgraph">
<area shape="rect" id="node3" href="free__block__list_8c.html#ae1a3d63476e1321750e8e4aedbc53f07" title="Overwrites the free block list in memory with the most recent version on disk." alt="" coords="184,56,256,83"/><area shape="rect" id="node5" href="super__block_8c.html#a6bea61bb8314c0f57646b8337d5adf48" title="Get the location of the free block list&#39;s first index block." alt="" coords="305,5,450,32"/><area shape="rect" id="node9" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="503,56,588,83"/><area shape="rect" id="node13" href="index__block_8c.html#a58c6c55e76e88de10da638a624574947" title="This function takes an index block data structure and returns the locations of all data blocks which ..." alt="" coords="329,131,425,157"/><area shape="rect" id="node7" href="glob__func_8c.html#a4f496ee5ac2e8ea15ed2d44dd16828a1" title="Allocate a buffer to write to memory of a given size." alt="" coords="499,5,591,32"/><area shape="rect" id="node11" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="641,56,719,83"/><area shape="rect" id="node16" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="515,119,576,145"/><area shape="rect" id="node18" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="503,169,588,196"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_icgraph.png" border="0" usemap="#free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_icgraph" alt=""/></div>
<map name="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_icgraph" id="free__block__list_8c_a4fb9e58d343f5d00bfddf8b2aabe4a05_icgraph">
<area shape="rect" id="node3" href="mount_8h.html#ad8988b7a3c735f8499da90b745024829" title="Attempt to mount the filesystem on disk." alt="" coords="184,5,243,32"/><area shape="rect" id="node5" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="291,5,360,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae1a3d63476e1321750e8e4aedbc53f07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfree__block__list.html">free_block_list</a>* reset_fbl </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overwrites the free block list in memory with the most recent version on disk. </p>
<p>Resets the free block list in memory by loading the free blocks list from disk and overwriting the static instance of the free block list in memory. This function is used to refresh the state of the free block list in memory if an error occurs.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to the static instance of free block list in memory, NULL if an error occurred.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_cgraph.png" border="0" usemap="#free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_cgraph" alt=""/></div>
<map name="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_cgraph" id="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_cgraph">
<area shape="rect" id="node3" href="super__block_8c.html#a6bea61bb8314c0f57646b8337d5adf48" title="Get the location of the free block list&#39;s first index block." alt="" coords="126,5,271,32"/><area shape="rect" id="node7" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="324,56,409,83"/><area shape="rect" id="node11" href="index__block_8c.html#a58c6c55e76e88de10da638a624574947" title="This function takes an index block data structure and returns the locations of all data blocks which ..." alt="" coords="151,131,247,157"/><area shape="rect" id="node5" href="glob__func_8c.html#a4f496ee5ac2e8ea15ed2d44dd16828a1" title="Allocate a buffer to write to memory of a given size." alt="" coords="321,5,413,32"/><area shape="rect" id="node9" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="462,56,541,83"/><area shape="rect" id="node14" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="336,119,397,145"/><area shape="rect" id="node16" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="324,169,409,196"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_icgraph.png" border="0" usemap="#free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_icgraph" alt=""/></div>
<map name="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_icgraph" id="free__block__list_8c_ae1a3d63476e1321750e8e4aedbc53f07_icgraph">
<area shape="rect" id="node3" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="304,5,387,32"/><area shape="rect" id="node7" href="free__block__list_8h.html#a4fb9e58d343f5d00bfddf8b2aabe4a05" title="Obtains a handle to the free block list static instance, regardless of whether it is available in mem..." alt="" coords="125,56,256,83"/><area shape="rect" id="node12" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="153,107,228,133"/><area shape="rect" id="node5" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="435,56,504,83"/><area shape="rect" id="node9" href="mount_8h.html#ad8988b7a3c735f8499da90b745024829" title="Attempt to mount the filesystem on disk." alt="" coords="316,56,375,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a24d3e02317587656b22b7207cdb3fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfree__block__list.html">free_block_list</a>* sync_fbl </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchronizes the free block static instance in memory by writing it to disk. </p>
<p>Writes the static free block list in memory to disk. This synchronizes the static free block list in memory with the contents on disk, making the current state of the free blocks on disk permanent.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to the static instance of free block list in memory, NULL if an error occurred synchronizing the free block list to disk.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_cgraph.png" border="0" usemap="#free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_cgraph" alt=""/></div>
<map name="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_cgraph" id="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_cgraph">
<area shape="rect" id="node3" href="super__block_8c.html#a6bea61bb8314c0f57646b8337d5adf48" title="Get the location of the free block list&#39;s first index block." alt="" coords="126,32,271,59"/><area shape="rect" id="node11" href="index__block_8c.html#a58c6c55e76e88de10da638a624574947" title="This function takes an index block data structure and returns the locations of all data blocks which ..." alt="" coords="151,107,247,133"/><area shape="rect" id="node19" href="write__file_8c.html#a0a44cca95b59aaddaa4767ac5adb546d" title="Segments a buffer into block sized chunks of data." alt="" coords="135,157,263,184"/><area shape="rect" id="node21" href="block__func_8c.html#a8d2c516f00e918d009b5fbaf1cfa463b" title="A wrapper for the put_block function." alt="" coords="155,208,243,235"/><area shape="rect" id="node5" href="glob__func_8c.html#a4f496ee5ac2e8ea15ed2d44dd16828a1" title="Allocate a buffer to write to memory of a given size." alt="" coords="321,5,413,32"/><area shape="rect" id="node7" href="block__func_8c.html#a1dcadd38a012a1218ab2100bda116861" title="A wrapper for the get_block function." alt="" coords="324,56,409,83"/><area shape="rect" id="node9" href="blockio_8c.html#aba494f8ba12c5888abc3991a9a1a4fa0" title="Retrieves a block from disk." alt="" coords="462,56,541,83"/><area shape="rect" id="node14" href="glob__func_8c.html#ae6b48ca0727ba8a874b5442254e1d31a" title="Concatenate two arrays." alt="" coords="336,107,397,133"/><area shape="rect" id="node16" href="glob__func_8c.html#a12db81dbcf4d3c41013509bb19d7053c" title="Concatenate two byte arrays." alt="" coords="324,157,409,184"/><area shape="rect" id="node23" href="blockio_8c.html#a800219862241422fe7dee4411b4b995e" title="Writes a block to disk." alt="" coords="327,208,406,235"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_icgraph.png" border="0" usemap="#free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_icgraph" alt=""/></div>
<map name="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_icgraph" id="free__block__list_8c_a1a24d3e02317587656b22b7207cdb3fe_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="125,56,208,83"/><area shape="rect" id="node10" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="263,107,345,133"/><area shape="rect" id="node13" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="129,157,204,184"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="257,5,351,32"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="400,81,469,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adafbfcac2573a9ee6a15645d4fe825c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfree__block__list.html">free_block_list</a>* update_fbl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td>
          <td class="paramname"><em>used</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="glob__data_8h.html#a9d4937e46b9fac69334d5fc7ea3f37a6">locations</a>&#160;</td>
          <td class="paramname"><em>free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor method for the free block list static instance in memory. </p>
<p>The update FBL method updates the static FBL entry in memory. It will take an array of all the locations to mark as used as the first argument, and an array of all the locations to mark as unused as the second argument. If the arguments used or free are NULL then no blocks are marked for that type.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Parameters used and free MUST be NULL terminated arrays of locations.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">used</td><td>A NULL terminated array of locations to mark as used in the free block list, if it is NULL then no locations are marked as used.</td></tr>
    <tr><td class="paramname">free</td><td>A NULL terminated array of locations to mark as free in the free block list, if it is NULL then no locations are marked as free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to the static instance of free block list in memory, NULL if an error occurred.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_adafbfcac2573a9ee6a15645d4fe825c0_icgraph.png" border="0" usemap="#free__block__list_8c_adafbfcac2573a9ee6a15645d4fe825c0_icgraph" alt=""/></div>
<map name="free__block__list_8c_adafbfcac2573a9ee6a15645d4fe825c0_icgraph" id="free__block__list_8c_adafbfcac2573a9ee6a15645d4fe825c0_icgraph">
<area shape="rect" id="node3" href="create__file_8h.html#a10498692a07aacf1e88110005e3f2f3f" title="Creates a new file or directory at the path specified." alt="" coords="669,111,752,138"/><area shape="rect" id="node10" href="delete__file_8h.html#ad7cc263f6e467c2eb2f8f73a6eb9d1c3" title="Delete a file with the pathname specified." alt="" coords="669,339,752,366"/><area shape="rect" id="node13" href="free__block__list_8h.html#acbfc0a3810742af6e976d135071261e1" title="Finds the next free block in the static free block list, marks it as used and returns the location of..." alt="" coords="136,238,243,264"/><area shape="rect" id="node16" href="_i__node_8h.html#ae46cace88988ba2b1d6fd8e63f68db5b" title="Unlinks a child&#39;s inode from the parent&#39;s index structure." alt="" coords="451,339,621,366"/><area shape="rect" id="node22" href="initialize_8h.html#a00a2a52d3dc5dd4ec595881132e0e280" title="Allocate all of the blocks in the free block list." alt="" coords="483,187,589,214"/><area shape="rect" id="node27" href="_i__node_8h.html#ad53d6e5ae20699bd6a8702c0e1a58d3a" title="Links the inode to a parent&#39;s index structure." alt="" coords="465,35,607,62"/><area shape="rect" id="node31" href="write__file_8h.html#a27cf11a1ac685bf2dbd4feca5f2a68dd" title="Write data to a file." alt="" coords="499,276,573,303"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="801,187,895,214"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="944,200,1013,227"/><area shape="rect" id="node19" href="index__block_8h.html#aef23bf42ec9f8215f800e36ed19f3684" title="Generates the indexes for the data blocks and then writes the indexes (which contain the locations of..." alt="" coords="291,187,402,214"/><area shape="rect" id="node25" href="index__block_8h.html#afd54d9d51e9832a5a52ac0aa470b0d12" title="Takes a series of loose data block locations and builds a new index to link them with an inode..." alt="" coords="297,288,396,315"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9e849ebe5efb8153894a337356a4e328"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structfree__block__list.html">free_block_list</a>* wipe_fbl </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinitializes the free block list in memory. </p>
<p>Wipes the contents of the free block list in memory, which sets all of the locations in the free block list in memory as free. This function is used to reset the free block list in memory after initializing a new disk.</p>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to the free block list, NULL if an error occurred.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Daniel Smullen</dd>
<dd>
Jonathan Gillett</dd>
<dd>
Joseph Heron</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU General Public License V3 </dd></dl>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="free__block__list_8c_a9e849ebe5efb8153894a337356a4e328_icgraph.png" border="0" usemap="#free__block__list_8c_a9e849ebe5efb8153894a337356a4e328_icgraph" alt=""/></div>
<map name="free__block__list_8c_a9e849ebe5efb8153894a337356a4e328_icgraph" id="free__block__list_8c_a9e849ebe5efb8153894a337356a4e328_icgraph">
<area shape="rect" id="node3" href="initialize_8h.html#a00a2a52d3dc5dd4ec595881132e0e280" title="Allocate all of the blocks in the free block list." alt="" coords="125,5,232,32"/><area shape="rect" id="node5" href="initialize_8h.html#a19433b013c630f41f2a2162275594858" title="Initialize the superblock for the file system." alt="" coords="281,5,375,32"/><area shape="rect" id="node7" href="sfstest_8c.html#a88d3b903798a494fd7297714fd0e5c4c" title="sfs_test" alt="" coords="424,5,493,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="free__block__list_8c.html">free_block_list.c</a></li>
    
    
    
  </ul>
</div>
</body>
</html>
